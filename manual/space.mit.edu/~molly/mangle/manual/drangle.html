<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
 "http://www.w3.org/TR/REC-html40/loose.dtd">

<html>
<head>
  <title>mangle : manual : commands</title>
  <meta http-equiv="Content-Type" content="text/html">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta name="description"
  content="mangle: a code to compute the spherical harmonics of an arbitrary angular mask.">
  <meta name="keywords"
  content="mangle, spherical harmonics, Large Scale Structure, Cosmic Microwave Background">
  <link href="../style/mangle_template.css" rel="stylesheet" type="text/css">
  
</head>
<body>

<div class="main">

<div class="title">
</div>

<div class="nav clear">

<ul class="menu centered">
    <li><a href="../">Overview</a></li>
    <li><a href="../download/">Download</a></li>
    <li><a href="../quickstart/">QuickStart</a></li>
    <li><a href="./">Manual</a></li>
    <li><a href="../references/">References</a></li>
</ul>

</div>

<br>

<div class="pagetitlebox">
<div class="pagetitle">
<img src="./manual.png" alt="manual">
</div>
<div class="pagesubtitle">
<h5>Commands</h5><!--img src="./commands.png" alt="commands" style="margin-left: 182.5px;"-->
</div>
</div>

<div class="contentbox">
<div class="submenu" style="width: 153px;">
<ul>
    <li><a href="./">Terms</a></li>
    <li><a href="./commands.html">Commands</a></li>
    <li><a href="./polyformat.html">Polygon Formats</a></li>
    <li class="last"><a href="./troubleshooting.html">Troubleshooting</a></li>
</ul>
</div>
<div class="content">
<p style="margin-left: 193px;"><br></p>
<h2>drangle</h2>
<p style="margin-left: 193px;">
<tt>drangle</tt>
computes, for a specified set of circles,
the angle subtended by that part of each circle lying with the mask.
Each circle is defined by the azimuth <tt>az</tt> and elevation <tt>el</tt>
of its centre,
and by its angular radius <tt>th</tt>.
The angle subtended is the weighted sum over polygons in the mask
of the angle subtended by the part of the circle within each polygon.
For example,
if the circle happens to lie entirely inside a polygon of weight 1,
then the angle is 2&#160;pi.
<br><br>
The result is equivalent to
the angular cross-correlation
(commonly denoted
&lt;DR&gt;,
or Data-Random,
in cosmological parlance)
between given points D
and points R in the mask separated from the D points by a given angle.
If the data points D are random points generated by
<tt><a href="./ransack.html">ransack</a></tt>,
then the result will be equivalent to
the angular auto-correlation
(commonly denoted
&lt;RR&gt;,
or Random-Random,
in cosmological parlance)
between pairs of points
in the mask separated by a given angle.
<br><br>
<tt>
drangle [-d] [-q] [-h] [-m&lt;a&gt;[u]] [-s&lt;n&gt;] [-e&lt;n&gt;] [-u&lt;inunit&gt;[,&lt;outunit&gt;]] [-p[+|-]&lt;n&gt;]
[-i&lt;f&gt;[&lt;n&gt;][u]] polygon_infile azel[th]_infile [th_infile] dr_outfile
</tt>
<br><br>
The first file given on the command line is the mask,
a polygon file <tt>polygon_infile</tt>.
<br><br>
If three files are given on the command line,
then the second file,
<tt>azelth_infile</tt>,
is taken to contain
the centre <tt>az</tt> and <tt>el</tt>, and radii <tt>th</tt>,
of each circle, as in
<br><br>
<tt>
Header lines<br>
...<br>
az<sub>1</sub>	el<sub>1</sub>	th<sub>11</sub>	th<sub>12</sub>	...	th<sub>1n<sub>1</sub></sub><br>
az<sub>2</sub>	el<sub>2</sub>	th<sub>21</sub>	th<sub>22</sub>	...	th<sub>2n<sub>2</sub></sub><br>
...
</tt>
<br><br>
The azimuth and elevation on each line
specifies the centre of concentric circles
with radii <tt>th</tt> running over the values in the rest of the line.
The number of values of <tt>th</tt> may vary from line to line.
If there are <i>m</i> centres,
and the <i>i</i>'th centre has
<i>n<sub>i</sub></i> radii,
then there are
<i>n<sub>1</sub></i>&#160;+&#160;<i>n<sub>2</sub></i>&#160;+&#160;...&#160;+&#160;<i>n<sub>m</sub></i>
circles altogether.
<br><br>
Alternatively,
if four files are given on the command line,
then the second file,
<tt>azel_infile</tt>,
is taken to contain the centre of each circle,
its azimuth <tt>az</tt> and elevation <tt>el</tt>,
as in
<br><br
<tt>
Header lines<br>
...<br>
az<sub>1</sub>	el<sub>1</sub><br>
az<sub>2</sub>	el<sub>2</sub><br>
...
</tt>
<br><br>
while the third file,
<tt>th_infile</tt>,
contains the angular radii <tt>th</tt>,
as in
<br><br>
<tt>
Header lines<br>
...<br>
th<sub>1</sub><br>
th<sub>2</sub><br>
...
</tt>
<br><br>
The azimuth and elevation on each line of the
<tt>azel_infile</tt>
file specifies the centre of concentric circles
with radii <tt>th</tt> running over all values in the
<tt>th_infile</tt>
file.
Thus if the second file <tt>azel_infile</tt> contains <i>m</i> centres,
and the third file <tt>th_infile</tt> contains <i>n</i> radii,
then the two files specify <i>mn</i> circles altogether.

<br><br>
The last of the three or four files specified on the command line
is the output file
<tt>dr_outfile</tt>.
<br><br>
The default is to write a full table of results to the output file,
a value for each input <tt>az</tt>, <tt>el</tt>, and <tt>th</tt>.
If there are separate <tt>azel_infile</tt> and <tt>th_infile</tt>
input files (4 files on the command line),
then the output file looks like:</p>
<pre style="margin-left: 193px;">
   <sub>  </sub>         th(u):
az(u)<sub> </sub> el(u)<sub></sub>  th<sub>1 </sub>    th<sub>2 </sub>    ...    th<sub>n </sub>

az<sub>1</sub>    el<sub>1</sub>    dr<sub>11</sub>    dr<sub>12</sub>    ...    dr<sub>1n</sub>
az<sub>2</sub>    el<sub>2</sub>    dr<sub>21</sub>    dr<sub>22</sub>    ...    dr<sub>2n</sub>

...
az<sub>m</sub>    el<sub>m</sub>    dr<sub>m1</sub>    dr<sub>mm</sub>    ...    dr<sub>mn</sub>
   Average:<sub>  </sub> dr<sub>1 </sub>    dr<sub>2 </sub>    ...    dr<sub>n </sub>

</pre>
<p style="margin-left: 193px;">
The first line is a header line.
The second line is a header line that repeats the values of <tt>th</tt>
from the <tt>th_infile</tt>.
The last, <tt>Average</tt>, line
contains the averages
<tt>dr<sub>j</sub></tt>
of the values
<tt>dr<sub>ij</sub></tt>,&#160;<tt>i</tt>&#160;=&#160;1,&#160;...,&#160;<tt>m</tt>,
on the preceding <tt>m</tt> lines.
<br><br>
If there is a single <tt>azelth_infile</tt>
file (3 files on the command line),
then the output file looks similar,
but without the final line containing the <tt>Average</tt>.
<br><br>
If you don't want the full table of results,
but only the summary <tt>Average</tt>,
then use the <tt>-h</tt> switch
</p>
<p style="margin-left: 233px;">
<tt>
	drangle -h polygon_infile azel_infile th_infile dr_outfile

</tt>
</p>
<p style="margin-left: 193px;">
The <tt>-h</tt> option is available
only if there are separate <tt>azel_infile</tt> and <tt>th_infile</tt>
input files (4 files on the command line).
<br><br>
The algorithm is as follows.
<tt>drangle</tt>
loops in turn through each point
<tt>az</tt>,&#160;<tt>el</tt>
of azimuth and elevation.
Thus two points take twice as much CPU time as one point.
For each point,
<tt>drangle</tt>
attempts to accelerate the computation with respect
to the angular separations <tt>th</tt>
by first computing the minimum and maximum angles between the point
and each polygon in the mask.
<tt>drangle</tt>
uses the information about the minimum and maximum angles
to decide whether the circle lies entirely
outside or entirely inside a polygon,
in which case the (unweighted) angle subtended within
the polygon is zero or 2&#160;pi.
In practical cases the angle subtended is often zero for
the great majority of polygons of a mask,
especially when the mask is composed of many polygons.
Since calculation of the subtended angle can be skipped
if the angle is zero, computation can be greatly speeded.
Further acceleration comes from
ordering the polygons in increasing order of the minimum angle
from the point to each polygon.
This allows the computation to loop to the next
value of <tt>th</tt> as soon as it hits a polygon
for which the subtended angle is zero,
rather than checking through large numbers of polygons
that all have zero subtended angle.
<br><br>
Back to <a href="./commands.html">list of commands</a>.

</p>

</div>
</div>

<div class="footer">
<a href="http://www.colorado.edu"><div class="footerleft">
<img src="../CU.jpg" alt="CU">
</div>
</a>
<a href="http://space.mit.edu"><div class="footerright2">
<img src="../mki.jpg" alt="MKI">
</div>
</a>
<a href="http://web.mit.edu"><div class="footerright1">
<img src="../mit.gif" alt="MIT">
</div>
</a>
</div>

</div>
</body>
</html>
